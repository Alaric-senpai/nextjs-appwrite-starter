# ğŸ¯ Role-Based Dashboard Architecture

## Complete System Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      User Authentication                            â”‚
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  Login   â”‚   â†’     â”‚  Verify  â”‚   â†’     â”‚   Role   â”‚         â”‚
â”‚   â”‚  Page    â”‚         â”‚  Creds   â”‚         â”‚  Assign  â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                    â”‚                â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                         â†“                                   â†“      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚                                   â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚      Client Role      â”‚          â”‚      Admin Role       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚                                   â”‚
                          â†“                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      CLIENT DASHBOARD               â”‚  â”‚      ADMIN DASHBOARD             â”‚
â”‚      /(client)/dashboard            â”‚  â”‚      /(admin)/dashboard          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚  â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     Client Sidebar           â”‚  â”‚  â”‚  â”‚    Admin Sidebar          â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚  â€¢ Dashboard                 â”‚  â”‚  â”‚  â”‚  ğŸ‘‘ Admin Panel          â”‚  â”‚
â”‚  â”‚  â€¢ Account Security          â”‚  â”‚  â”‚  â”‚  â€¢ Dashboard             â”‚  â”‚
â”‚  â”‚  â€¢ Link Account              â”‚  â”‚  â”‚  â”‚  â€¢ Users                 â”‚  â”‚
â”‚  â”‚  â€¢ Settings                  â”‚  â”‚  â”‚  â”‚  â€¢ Analytics             â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚  â€¢ Database              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚  â”‚  â€¢ Logs                  â”‚  â”‚
â”‚  â”‚  â”‚ User: John Doe         â”‚ â”‚  â”‚  â”‚  â”‚  â€¢ Settings              â”‚  â”‚
â”‚  â”‚  â”‚ Session: 45m           â”‚ â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚  â”‚ Admin: Jane Smith    â”‚â”‚  â”‚
â”‚  â”‚  [ Logout ]                  â”‚  â”‚  â”‚  â”‚  â”‚ Administrator        â”‚â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                                     â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  [ Logout ]               â”‚  â”‚
â”‚  â”‚     Main Content             â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚                                  â”‚
â”‚  â”‚  ğŸ“Š Stats Cards              â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”   â”‚  â”‚  â”‚  â”‚    Main Content           â”‚  â”‚
â”‚  â”‚  â”‚ âœ“ â”‚ â”‚ ğŸ›¡ â”‚ â”‚ ğŸ”— â”‚ â”‚ ğŸ“± â”‚   â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜   â”‚  â”‚  â”‚  â”‚  ğŸ“Š Admin Stats          â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  ğŸ¯ Quick Actions            â”‚  â”‚  â”‚  â”‚  â”‚ğŸ‘¥ â”‚ â”‚ğŸ“ˆ â”‚ â”‚ğŸ’¾ â”‚ â”‚ğŸ›¡ â”‚â”‚  â”‚
â”‚  â”‚  â€¢ Account Security          â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜â”‚  â”‚
â”‚  â”‚  â€¢ Link Account              â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚  ğŸ‘‘ Admin Actions        â”‚  â”‚
â”‚  â”‚  â„¹ï¸ Account Info             â”‚  â”‚  â”‚  â”‚  â€¢ Manage Users          â”‚  â”‚
â”‚  â”‚  Name: John Doe              â”‚  â”‚  â”‚  â”‚  â€¢ View Analytics        â”‚  â”‚
â”‚  â”‚  Email: john@example.com     â”‚  â”‚  â”‚  â”‚  â€¢ Database Management   â”‚  â”‚
â”‚  â”‚  Status: ğŸŸ¢ Active           â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  ğŸ”’ System Status        â”‚  â”‚
â”‚                                     â”‚  â”‚  â”‚  âœ… Auth Service         â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  âœ… Database             â”‚  â”‚
                                         â”‚  â”‚  âœ… OAuth                â”‚  â”‚
                                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                         â”‚                                  â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY VERIFICATION LAYERS                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 1: MIDDLEWARE                                                 â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                                       â”‚
â”‚  Request â†’ middleware.ts                                             â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Check session cookie exists? â”€â”€â”€NOâ”€â”€â†’ Redirect to login     â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Check role cookie? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€NOâ”€â”€â†’ Redirect to login       â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â””â”€â†’ Admin route + client role? â”€â”€YESâ”€â†’ Redirect to client dash  â”‚
â”‚                                                                       â”‚
â”‚  âœ… PASS â†’ Continue to Layer 2                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 2: LAYOUT VERIFICATION                                        â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                                       â”‚
â”‚  Layout Component (Server-side)                                      â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Call verifyUserRole(requiredRole)                           â”‚
â”‚     â”‚         â”‚                                                       â”‚
â”‚     â”‚         â”œâ”€â†’ Check cookie role                                  â”‚
â”‚     â”‚         â”œâ”€â†’ Verify active session                              â”‚
â”‚     â”‚         â””â”€â†’ Query database for actual role                     â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Cookie â‰  Database? â”€â”€â”€YESâ”€â†’ ğŸš¨ SECURITY ALERT               â”‚
â”‚     â”‚                                   â””â”€â†’ Log incident              â”‚
â”‚     â”‚                                   â””â”€â†’ Redirect to safe route   â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â””â”€â†’ All checks match? â”€â”€â”€â”€YESâ”€â†’ âœ… PASS â†’ Continue              â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 3: DATABASE VALIDATION                                        â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                                       â”‚
â”‚  verifyUserRole() Function                                           â”‚
â”‚     â”‚                                                                 â”‚
â”‚     1. Read role cookie â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ "admin"                    â”‚
â”‚     2. Get session from Appwrite â”€â”€â”€â”€â”€â”€â”€â†’ Valid session              â”‚
â”‚     3. Get user from session â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ user.$id                   â”‚
â”‚     4. Query database for user role â”€â”€â”€â”€â†’ SELECT role WHERE id=...  â”‚
â”‚     5. Compare all sources:                                          â”‚
â”‚        â€¢ Cookie says: "admin"                                        â”‚
â”‚        â€¢ Database says: "client"  â†â”€â”€â”€ ğŸš¨ MISMATCH DETECTED!        â”‚
â”‚                                                                       â”‚
â”‚     6. Log security event:                                           â”‚
â”‚        "[Security Alert] Role mismatch detected"                     â”‚
â”‚        { userId, cookieRole: "admin", dbRole: "client" }            â”‚
â”‚                                                                       â”‚
â”‚     7. Return: { valid: false, message: "Role verification failed" }â”‚
â”‚                                                                       â”‚
â”‚  âœ… AUTHORIZED: Cookie = Database = Required                         â”‚
â”‚  âŒ BLOCKED: Any mismatch or missing data                            â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Attack Prevention Example

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCENARIO: Cookie Manipulation Attack                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Attacker logs in as CLIENT user
   â†“
   Cookies set:
   â€¢ session_secret = "abc123..."
   â€¢ user_role = "client"
   â€¢ Database has: role = "client"

Step 2: Attacker opens DevTools
   â†“
   Manually edits cookie:
   â€¢ user_role = "admin" â† TAMPERED

Step 3: Attacker navigates to /(admin)/dashboard
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  LAYER 1: Middleware                â”‚
   â”‚  â€¢ Cookie says "admin" âœ“            â”‚
   â”‚  â€¢ Session exists âœ“                 â”‚
   â”‚  â†’ PASS to next layer               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  LAYER 2: Layout                    â”‚
   â”‚  Calls verifyUserRole('admin')      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  LAYER 3: Database Check            â”‚
   â”‚                                     â”‚
   â”‚  Cookie role:    "admin"            â”‚
   â”‚  Database role:  "client"           â”‚
   â”‚                                     â”‚
   â”‚  âŒ MISMATCH DETECTED!              â”‚
   â”‚                                     â”‚
   â”‚  Actions:                           â”‚
   â”‚  1. Log security alert              â”‚
   â”‚  2. Return { valid: false }         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  RESULT: ACCESS DENIED              â”‚
   â”‚                                     â”‚
   â”‚  â€¢ Redirect to /(client)/dashboard  â”‚
   â”‚  â€¢ Error: "admin_access_denied"     â”‚
   â”‚  â€¢ Security log entry created       â”‚
   â”‚  â€¢ Attacker blocked ğŸ›¡ï¸              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… ATTACK PREVENTED!
```

## Route Structure

```
app/
â”‚
â”œâ”€â”€ (auth)/                          â† Public auth pages
â”‚   â”œâ”€â”€ login/
â”‚   â”œâ”€â”€ signup/
â”‚   â””â”€â”€ oauth/
â”‚
â”œâ”€â”€ (client)/                        â† Protected client area
â”‚   â”œâ”€â”€ layout.tsx                   â† Sidebar + verification
â”‚   â””â”€â”€ dashboard/
â”‚       â”œâ”€â”€ page.tsx                 â† Main dashboard
â”‚       â”œâ”€â”€ account-security/        â† OAuth management
â”‚       â”œâ”€â”€ link-account/            â† Link providers
â”‚       â””â”€â”€ settings/                â† User settings
â”‚
â””â”€â”€ (admin)/                         â† Protected admin area
    â”œâ”€â”€ layout.tsx                   â† Sidebar + strict verification
    â””â”€â”€ dashboard/
        â”œâ”€â”€ page.tsx                 â† Admin dashboard
        â”œâ”€â”€ users/                   â† User management
        â”œâ”€â”€ analytics/               â† System analytics
        â”œâ”€â”€ database/                â† Database tools
        â”œâ”€â”€ logs/                    â† Audit logs
        â””â”€â”€ settings/                â† System settings
```

## Access Matrix

```
Route                          | Client | Admin | Public
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/                              |   âœ“    |   âœ“   |   âœ“
/(auth)/login                  |   âœ—    |   âœ—   |   âœ“
/(auth)/signup                 |   âœ—    |   âœ—   |   âœ“
/(client)/dashboard            |   âœ“    |   âœ“   |   âœ—
/(client)/dashboard/*          |   âœ“    |   âœ“   |   âœ—
/(admin)/dashboard             |   âœ—    |   âœ“   |   âœ—
/(admin)/dashboard/*           |   âœ—    |   âœ“   |   âœ—

Legend:
âœ“ = Allowed
âœ— = Blocked (redirected)
```

## Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend Layer              â”‚
â”‚  â€¢ Next.js 14 (App Router)          â”‚
â”‚  â€¢ React Server Components          â”‚
â”‚  â€¢ Client Components                â”‚
â”‚  â€¢ Tailwind CSS                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Server Actions Layer          â”‚
â”‚  â€¢ Authentication actions           â”‚
â”‚  â€¢ Role verification                â”‚
â”‚  â€¢ Session management               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Middleware Layer             â”‚
â”‚  â€¢ Route protection                 â”‚
â”‚  â€¢ Cookie validation                â”‚
â”‚  â€¢ Security headers                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Backend Services              â”‚
â”‚  â€¢ Appwrite Authentication          â”‚
â”‚  â€¢ Appwrite Database                â”‚
â”‚  â€¢ Session Store                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Status:** âœ… Production Ready  
**Security Level:** Maximum (Triple verification)  
**Architecture:** Multi-layer protection with anti-spoofing
